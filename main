#include <iostream>
#include "Header.h"  //this is what the header file will be declared with all the nice functions declarations
#define DBMAX 10
int main()
{

//declare hashtable

passwordh* hashtable = new passwordh[hashsize];


 string test = "boD78&";

 //testbed for encryption and hashing:
 vector<int>transfer = encrypt(test);
 cout << "after encryption of test string boD78&"<<endl;

 for (int i = 0; i < transfer.size(); i++) {
     cout << transfer[i]<<endl;
 }

 insert(transfer, hashtable);

 display(hashtable);

 vector<int>retrive = search(transfer, hashtable);
 
 cout << "retrived password is(after calling search function): " << endl;
 for (int i = 0; i < retrive.size(); i++) {
     cout << retrive[i] << endl;
 }
 string decrypted = decrypt(retrive);

 cout << "the string decrypted is: " << decrypted<<endl;









     //arrays
    spot array[20];

     student db[DBMAX];
 int programloop = 1;
int position=0;
 //itializie both of these

 //array:

 spot de;

 for (int i = 0; i < 20; i++) {
     array[i]=spot(0,0,0, false, true, 0, i);
 }




//initialize a database that will hold 10 students
for (int i = 0; i < DBMAX; i++) {
    db[i] = student();
}



do{
  int loginput,id, signinid ;
 string first, last, password, signinpassword;
vector<int>transfer2;
  cout << "type 1 for login, type 2 for signup, type 3 for exit" << endl;
  cin >> loginput;
  switch (loginput) {
  case 1:
       cout << "enter in your id:"<<endl;
 cin >> signinid;

 cout << "enter in password: " << endl;
 cin >> password;
 while (passcheck(password, hashtable)!=true) {
     cout << " Invalid, enter in password again: " << endl;
     cin >> password;
 }

 cout << "logging in" << endl;
      break;

  case 2:
     if (position == DBMAX) {
    cout << "database full, cannot add anymore." << endl;
    break;
}
    
    cout << "enter in your first name: " << endl;
    cin >> first;
    db[position].setfirst(first);

    cout << "enter in last name: " << endl;
    cin >> last;
    db[position].setlast(last);

    cout << "enter in your student id: " << endl;
    cin >> id;
    db[position].setid(id);

    cout << "create a new password: " << endl;
    cin >> password;
    while (passcheck(password, hashtable) == true) {
    cout << " Invalid, enter in unique password again: " << endl;
    cin >> password;
}
    db[position].setpassword(password);  //do hashing and encryption here
  transfer2 = encrypt(password);
 insert(transfer2, hashtable);
 cout << "the hashtable now looks like this:";
 display(hashtable);
    position++;
   transfer2.clear();
      break;

  case 3:

      return 0;
      break;

  }



 //initialize parking lot functions:
 int input;
 string cn; //future student attributes: credit card number and its security code
 do {
     cout << "type 1 for displaying the available parking spots, type 2 to reserve a parking spot, type 3 for payment"<<endl;
     cin >> input;
     int rloop = 0;
     switch(input){
     case 1:
        for (int i = 0; i < 20; i++) {
   
    if (array[i].getempty() == 1) {
        cout << "spot " << i << " is empty" << endl;
    }
}
         break;

     case 2:
        int in, inh, inm, ins;

while (rloop == 0) {
    cout << "type which spot you want to reserve:" << endl;
    cin >> in;
    while (in >= 20) {
        cout << "spot is not available, try again and enter the spot you want to reserve:" << endl;
         cin >> in;
    }
    if (array[in].getempty()==1){
 cout << "spot is empty, reserving it"<<endl;
 reserve(array[in]);

 cout << "how long do you plan to reserve this spot:" << endl;  //max time allowed 1 day, 1 hour, 1 min


 cout << "enter # of hours:" << endl;
 cin >> inh;
 while (inh > 24) {
     cout << "invalid input for hours, please enter in # of hours again:" << endl;
         cin >> inh;
 }
 array[in].settimehour(inh);

 cout << "enter # of minutes:" << endl;
 cin >> inm;
 while (inm > 60) {
     cout << "invalid input for minutes, please enter in # of minutes again:" << endl;
     cin >> inm;
 }
 array[in].settimeminute(inm);

 cout << "enter # of seconds:" << endl;
 cin >> ins;
 while ( ins > 60) {
     cout << "invalid input for seconds, please enter in # of seconds again:" << endl;
     cin >> ins;
 }
 array[in].settimesecond(ins);

array[in].calculatedue();
 rloop = 1;

}
}
         break;

     case 3:
         int securitycode;
cout <<"you owe: "<< array[in].getdue()<<"$, PAY NOW!!"<<endl;
//simulate user pays here via credit card
cout << "enter in credit card number"<<endl;
cin >> cn;

cout << "enter in card's security code:" << endl;
cin >> securitycode;

cout << "Card accepted, processing payment" << endl;
array[in].setdue(0);

//at this point, assume user leaves the parking spot
array[in].setempty(1);
         break;

      case 4:
     programloop= 0;
     break;
     }


 } while (programloop==1);


}while(1);
}

